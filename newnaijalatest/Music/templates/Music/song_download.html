{% extends 'Music/../../../Frontend/templates/Frontend/base.html' %}
{% load static %}
{% load hitcount_tags %}
<title> {% block title %}All Songs{% endblock %}</title>

<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.0.10/css/all.css"
          integrity="sha384-+d0P83n9kaQMCwj8F4RJB66tzIwOKmrdb46+porD/OvrJ+37WqIM7UoBtwHO6Nlg" crossorigin="anonymous">
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
<script src="//code.jquery.com/jquery-migrate-1.2.1.min.js"></script>
<script src="{% static 'hitcount/jquery.postcsrf.js' %}"></script>
{% block body %}

    <style>
    .audio-player {
        background: white;
        border: 1px solid #acacac;
        width: 50vw;
        text-align: center;
        display: flex;
        flex-flow: row;
        margin: 4rem 0 4rem 0;
    }
  .album-image {
    min-height: 100px;
    width: 110px;
      background-image: url("{% static 'image/apostle.fw.png'%}");
    background-size: cover;
  }
    .player-controls {
    align-items: center;
    justify-content: center;
    margin-top: 2.5rem;
    flex: 3;}
    progress {
      width: 90%;
    }
     progress[value] {
      -webkit-appearance: none;
      appearance: none;
      background-color: white;
      color: blue;
      height: 5px;
    }
     progress[value]::-webkit-progress-bar {
      background-color: lightgrey;
      border-radius: 2px;
      border: 1px solid #acacac;
      color: blue;
    }
    progress::-webkit-progress-value {
      background-color: darkgoldenrod;
    }
     p {
      font-size: 1.6rem;
    }
    #play-btn {
    background-image: url('{% static 'image/pausemain.fw.png' %}');
    background-size: cover;
    width: 75px;
    height: 75px;
        position: absolute;
    top: 35%;
    left: 50%;
        bottom: 70%;
        right: 50%;
    transform: translate(-50%, -50%);
    }
      .audio-player #play-btn.pause {
  background-image: url('{% static 'image/playmain.fw.png' %}');
          z-index: 3;
}
    #download-audio {
  border-radius: 25px;
  background: #73AD21;
  padding: 20px;
  width: 200px;
  height: 150px;
}
    </style>




    <div class="container" style="background-color:white; margin-top: 0.5%">


    {% for audios in play_audio %}
       <div class="row">
            <div class="col-lg-8" >
                <a href="#" class="btn btn-dark" role="button"><strong>[Music]: </strong>{{ audios.music.song_title }}
                    by <strong> {{audios.music.artist  }}</strong></a>
            </div>
        </div><br>
        <div class="row">
        <div class="col-lg-6">
                 <h6 style="color:#535362"><strong > Featured Artist - </strong>{{ featured_artist.music.featured_artist }}</h6>
                  <h6 style="color:#535362"><strong>Released on: </strong>{{ featured_artist.uploaded_at.year }}</h6><br>
              </div>
        <div class="col-md-6">
           <h6 style="color:#535362"><strong>Posted on: </strong>{{ audios.uploaded_at.date }}</h6>
        </div>
        </div>
        <hr>
            <!---<div class="col-lg-12">
              <div class="col-lg-6">
                 <h6> Featured Artist - <strong>{{ featured_artist.music.featured_artist }}</strong></h6>
                  <h6>Released on <strong>{{ featured_artist.uploaded_at.year }}</strong></h6>
              </div>
                <div class="col-lg-6">
                   <h6>Posted  on <strong>{{ audios.uploaded_at.date }}</strong></h6>
                </div>
            </div>--->

      <div class="row">
      <div class="col-sm-12">
          <img src="{{ audios.cover_image.url }}" class="img-fluid center-block" style="height: 300px;width: 1000px">
      </div><br>
            <div class="col-lg-12">
                <br><h6 style="font-family: 'Times New Roman';font-size: large; color:#535362">{{audios.music.about_song |safe }}</h6>
            </div>
        </div>
    {% endfor %}

    <!----{% for audios in play_audio  %}
    <div class="row">
    <div class="col-6">
    <strong>[Music]  - </strong>
    </div>
    <div class="col-6">

    </div>
    </div>
    {% endfor %}--->



    <!----<div class="row">
        <div class="col-12">
    <img src="{% static 'image/hair.fw.png' %}"  class="img-fluid" style="width: 1000px; height: 180px"/>
            <h6>like the Wig?.......kindly hook us up on whatsapp : <a href="">link</a> </h6>
        </div>
    </div>------>
    <div class="row">
        <div class="col-lg-12">
            <div class="too" style="float: right">
                <a href="https://www.facebook.com/sharer/sharer.php?u=http://CodingForEntrepreneurs.com/">
                    <i class="fab fa-facebook-square fa-2x" style="color: #3B5998"></i>
                </a>
                <a href="" ><i class="fab fa-google-plus-square fa-2x" style="color: #dc4e41"></i></a>
                <a href=""  ><i class="fab fa-twitter-square fa-2x" style="color: #55acee"></i></a>
                <a href="" ><i class="fab fa-linkedin fa-2x" style="color:  #0077B5"></i></a>
                <a href=""><i class="fab fa-whatsapp-square fa-2x" style="color: #25d366"></i></a>
            </div>
        </div>
    </div>
    <hr>
    <!----<div class=" row">
        <div class="col-lg-1">
            <h5 style="font-family: 'Arial Black'; font-size: x-large;"><i class="fas fa-share-alt"></i></h5>
        </div>
        <div class="clo-lg-2">
            <a href="https://www.facebook.com/sharer/sharer.php?u=http://CodingForEntrepreneurs.com/">
            <img src="{% static 'image/f.fw.png' %}" class="img-fluid" height="10"/>
        </a>
        </div>
        <div class="clo-lg-2">
            <a href="https://www.facebook.com/sharer/sharer.php?u=http://CodingForEntrepreneurs.com/">
            <img src="{% static 'image/what.fw.png' %}" class="img-fluid" height="10"/>
        </a>
        </div>
        <div class="clo-lg-2">
            <a href="https://www.facebook.com/sharer/sharer.php?u=http://CodingForEntrepreneurs.com/">
            <img src="{% static 'image/ints.fw.png' %}" class="img-fluid" height="10"/>
        </a>
        </div>
        <div class="clo-lg-2">
            <a href="https://www.facebook.com/sharer/sharer.php?u=http://CodingForEntrepreneurs.com/">
            <img src="{% static 'image/linkdn.fw.png' %}" class="img-fluid" height="10"/>
        </a>
        </div>
    </div>------------>
    {% for audios in play_audio %}
        <div class="row" style="margin-top: 1%">
    <div class="audio-player">
    <div class="col-lg-4">
          <img src="{{ audios.cover_image.url }}" class="img-fluid" style="margin-top: 4%; display: block; height: 100px; width: 1000px"  />

            <div id="play-btn"></div>
    </div>
    <div class="audio-wrapper" id="player-container" href="javascript:;">
      <audio id="player" ontimeupdate="initProgressBar()">
			 <source src='{{ audios.audio.url }}' type='audio/mp3' class="img-fluid">
			</audio>
    </div>
    <div class="player-controls scrubber">
        <div class="row">
           <div class="col-sm-6">
              <strong>{{ audios.music.song_title }}</strong>
           </div>
            <div class="col-sm-4" style="margin-top: -3%">
                    <a href="{{ audios.audio.url }}" style="text-decoration: none;color: black" download="{{ audios.audio.url }}">
                        <i class="fas fa-arrow-alt-circle-down fa-2x" style="color:#ffc926 "></i>
                        {% get_hit_count_js_variables for audios as hitcount %}
                    {% get_hit_count for audios as total_hits %}
                        <script type="text/javascript">
                        jQuery(document).ready(function($) {
                        // use the template tags in our JavaScript call
                        $.postCSRF("{{ hitcount.ajax_url }}", { hitcountPK : "{{ hitcount.pk }}" })
                        .done(function(data){$('<i />').text(data.hit_counted).attr('id','hit-counted-value').appendTo('#hit-counted');
                        $('#hit-response').text(data.hit_message);
                        }).fail(function(data){
                        console.log('POST failed');
                        console.log(data);
                        });
                        });
                        </script>
                    </a>
            </div>
         </div>
        <div class="row">
            <div class="col-sm-6">
               <a href="#" class="btn btn-dark" role="button" style="border-radius: 20px"><strong>{{ total_hits }} </strong>
                    Download{{ total_hits|pluralize }}</a>
            </div>
        </div>
      <span id="seekObjContainer">
			  <progress id="seekObj" value="0" max="1"></progress>
			</span>
      <br>
      <small style="float: left; position: relative; left: 15px;" class="start-time"></small>
      <small style="float: right; position: relative; right: 20px;" class="end-time"></small>

    </div>
    <div class="album-image"></div>
  </div>
        </div>
         <hr>
        <h6 style="text-align: center">You may also like <strong>{{ audios.music.artist }}'s</strong>  related Songs</h6>
    {% endfor %}
    <div class="row">
    {% for songs in  first_six_artist_song %}
                <div class="col-md-6 " style="padding-left: 1px;padding-right: 1px">
                    <div class="card card-img-top ">
                        <a href="{% url 'Music:song_download' songs.slug %}" style="text-decoration: none">
                            <img src="{{ songs.cover_image.url }}" class="img-fluid" style="height: 160px; width: 1000px;">
                            <h6 style="margin-top: -15%;color:white">{{ songs.music.song_title }}</h6>
                            <h6 style="text-decoration: none; color:white"><strong>Music : </strong>{{ songs.music.genre }}</h6>
                        </a>

                        <!---<div class="row">
                            <div class="col-md-4">
                                <a href="#" style="margin-left: 5px;color: darkgray"> <i class="fas fa-share-alt" style="color: #F0F0F0"></i>&nbsp;7</a>
                            </div>
                            <div class="col-md-4">
                                <a href="#" style="margin-left: 5px;color: darkgray"> <i class="fas fa-download" style="color: #F0F0F0"></i></i>&nbsp;7</a>
                            </div>
                             <div class="col-md-4" style="color: darkgray">
                                 <i class="fas fa-eye" style="color: #F0F0F0"></i>7
                             </div>

                        </div>-->

                    </div>

                </div>
                {% cycle '' '' '' '' '' '<div class="clearfix visible-lg"></div>' %}
            {% endfor %}



    </div>
    </div>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
    <script>
    function calculateTotalValue(length) {
  var minutes = Math.floor(length / 60),
    seconds_int = length - minutes * 60,
    seconds_str = seconds_int.toString(),
    seconds = seconds_str.substr(0, 2),
    time = minutes + ':' + seconds

  return time;
}

function calculateCurrentValue(currentTime) {
  var current_hour = parseInt(currentTime / 3600) % 24,
    current_minute = parseInt(currentTime / 60) % 60,
    current_seconds_long = currentTime % 60,
    current_seconds = current_seconds_long.toFixed(),
    current_time = (current_minute < 10 ? "0" + current_minute : current_minute) + ":" + (current_seconds < 10 ? "0" + current_seconds : current_seconds);

  return current_time;
}

function initProgressBar() {
  var player = document.getElementById('player');
  var length = player.duration
  var current_time = player.currentTime;

  // calculate total length of value
  var totalLength = calculateTotalValue(length)
  jQuery(".end-time").html(totalLength);

  // calculate current value time
  var currentTime = calculateCurrentValue(current_time);
  jQuery(".start-time").html(currentTime);

  var progressbar = document.getElementById('seekObj');
  progressbar.value = (player.currentTime / player.duration);
  progressbar.addEventListener("click", seek);

  if (player.currentTime == player.duration) {
    $('#play-btn').removeClass('pause');
  }

  function seek(evt) {
    var percent = evt.offsetX / this.offsetWidth;
    player.currentTime = percent * player.duration;
    progressbar.value = percent / 100;
  }
};

function initPlayers(num) {
  // pass num in if there are multiple audio players e.g 'player' + i

  for (var i = 0; i < num; i++) {
    (function() {

      // Variables
      // ----------------------------------------------------------
      // audio embed object
      var playerContainer = document.getElementById('player-container'),
        player = document.getElementById('player'),
        isPlaying = false,
        playBtn = document.getElementById('play-btn');

      // Controls Listeners
      // ----------------------------------------------------------
      if (playBtn != null) {
        playBtn.addEventListener('click', function() {
          togglePlay()
        });
      }

      // Controls & Sounds Methods
      // ----------------------------------------------------------
      function togglePlay() {
        if (player.paused === false) {
          player.pause();
          isPlaying = false;
          $('#play-btn').removeClass('pause');

        } else {
          player.play();
          $('#play-btn').addClass('pause');
          isPlaying = true;
        }
      }
    }());
  }
}

initPlayers(jQuery('#player-container').length);
    </script>
<script>
var x = document.getElementById("myAudio");

function playAudio() {
    x.play();
}

function pauseAudio() {
    x.pause();
}
</script>

{% endblock %}